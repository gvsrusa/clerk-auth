# Test Plan: Multiplayer Chess Feature

## 1. Introduction
This document outlines the test plan for the "Multiplayer Chess" feature of the web-based chess application. The purpose of this plan is to define the scope, strategy, resources, and schedule of testing activities to ensure the multiplayer feature meets the specified requirements and quality standards.

## 2. Feature Under Test
The "Multiplayer Chess" feature allows registered users to:
*   Create and join public or private chess games.
*   Play against other users in real-time.
*   Utilize game controls like offering draws and resigning.
*   View game history.
*   Receive in-game notifications for turns and game events.
This feature relies on Clerk for authentication and WebSockets for real-time communication.

## 3. Scope of Testing

### 3.1. In Scope (MVP)
*   **FR1:** User Authentication via Clerk for multiplayer access.
*   **US1/AC1/FR2:** Game Creation (public and private).
*   **US2/AC2/FR3:** Game Lobby/Discovery for public games.
*   **US3/AC3:** Joining open public games.
*   **US4/AC4:** Turn Notifications (visual and optional audio).
*   **US5/AC5/FR4:** Real-time Move Synchronization.
*   **US6/AC6/FR7:** Offering a draw.
*   **US7/AC7/FR7:** Accepting/Declining a draw offer.
*   **US8/AC8/FR8:** Resigning from a game.
*   **US9/AC9/FR5/FR6:** Game Status Display (turn, check, checkmate, stalemate, etc.).
*   **US10/AC10/FR9:** Viewing personal multiplayer game history.
*   **US11/AC11/FR10:** Invitation System for private games.
*   **FR11:** Basic Connection Handling (e.g., opponent disconnected message).
*   **NFR1:** Performance (move latency < 2s, quick lobby load).
*   **NFR3:** Reliability (game state persistence, basic reconnection if specified).
*   **NFR4:** Security (Clerk-based auth, secure communication).
*   **NFR5:** Usability (intuitive interface, clear notifications).
*   Core chess rule enforcement (leveraging `chess.js`).

### 3.2. Out of Scope (MVP)
*   Player ratings, ELO system, leaderboards.
*   Tournament modes.
*   Spectator mode.
*   In-game chat functionality.
*   Advanced time controls (beyond a single simple/untimed).
*   Rematch functionality.
*   Post-game analysis board.
*   Guest play (non-registered users).
*   Notifications outside the application (email, push).
*   **NFR2:** Scalability testing beyond initial support for 100 concurrent games (focus is on functional correctness for MVP).

## 4. Test Strategy

### 4.1. Testing Levels
*   **Component Testing:** Individual UI components (e.g., game board, lobby list item, notification pop-ups) will be tested in isolation where feasible, primarily by developers.
*   **Integration Testing:** Testing interactions between components, such as frontend with backend APIs, WebSocket communication, and integration with Clerk and `chess.js`.
*   **System Testing:** End-to-end testing of the complete multiplayer feature, simulating real user scenarios from login to game completion.
*   **Acceptance Testing:** Validating that the feature meets user stories and acceptance criteria.

### 4.2. Testing Types
*   **Functional Testing:** Verifying that all features listed in scope work as per the requirements. This will be the primary focus.
*   **UI/UX Testing (Usability Testing):** Ensuring the interface is intuitive, user-friendly, and aligns with UI/UX considerations. Checking for clarity of notifications, game status, etc.
*   **Performance Testing (Basic):** Monitoring move transmission latency and lobby loading times to ensure they meet NFR1. Formal load testing is out of scope for MVP but basic responsiveness will be checked.
*   **Security Testing (Basic):** Verifying that authentication via Clerk is enforced for multiplayer features and that basic secure communication practices are followed for game data. Deep security penetration testing is out of scope.
*   **Real-time Communication Testing:** Specifically testing the reliability and speed of WebSocket events for move synchronization, draw offers, etc.
*   **Compatibility Testing:** Testing on a limited set of common browsers (e.g., Chrome, Firefox, Safari - latest versions).

### 4.3. Test Approach
*   Testing will be primarily manual for this phase, focusing on executing defined test cases.
*   Exploratory testing will be conducted to uncover issues not covered by scripted test cases.
*   Bug tracking will be done using a designated issue tracking system.

## 5. Test Environment

### 5.1. Client
*   **Browsers:** Latest stable versions of Google Chrome, Mozilla Firefox, Safari.
*   **Operating Systems:** Windows 10/11, macOS, (Linux if resources permit).
*   **Network:** Simulated normal and potentially poor network conditions (using browser dev tools).

### 5.2. Server
*   **Backend:** Development/Staging environment mirroring production setup.
*   **Database:** Test database with appropriate schema and test data.
*   **WebSocket Server:** Deployed WebSocket service for testing.

### 5.3. Dependencies
*   **Clerk:** Configured test environment/instance for user authentication.
*   **`chess.js`:** Integrated library for chess logic.

## 6. Test Data Requirements
*   **User Accounts:**
    *   Multiple registered user accounts (at least 2-4 for concurrent game testing).
    *   Usernames for invitation testing.
*   **Game Data:**
    *   Public games (created by different users).
    *   Private games (created via invitation).
    *   Games in various states (ongoing, check, checkmate, stalemate, draw offered, etc.).
    *   Game history entries for multiple users.

## 7. Risks and Mitigation
| Risk                                     | Likelihood | Impact | Mitigation                                                                                                |
| ---------------------------------------- | ---------- | ------ | --------------------------------------------------------------------------------------------------------- |
| WebSocket connectivity issues            | Medium     | High   | Thorough testing of connection/disconnection scenarios. Clear error messaging.                            |
| Game state synchronization errors        | Medium     | High   | Rigorous testing of move sequences, draw offers, resignations. Logging on server/client for debugging.    |
| Issues with Clerk integration            | Low        | Medium | Early testing of authentication flows.                                                                    |
| Performance bottlenecks under load       | Medium     | Medium | Basic performance checks; defer extensive load testing post-MVP if issues arise.                        |
| UI/UX not intuitive for users            | Medium     | Medium | Early involvement of UX review if possible; gather feedback during testing.                               |
| Incomplete `chess.js` integration        | Low        | High   | Verify all standard chess rules are correctly enforced via the library.                                   |
| Cross-browser compatibility issues       | Medium     | Medium | Test on targeted browsers; prioritize fixing issues on major browsers.                                     |
| Delays in setting up test environment    | Low        | Medium | Plan and prepare test environment and data in advance.                                                    |

## 8. Test Deliverables
*   This Test Plan document.
*   Test Case Suite (detailed in section 9).
*   Bug Reports (logged in an issue tracking system).
*   Test Summary Report (upon completion of testing, summarizing results, coverage, and outstanding issues).

## 9. Test Cases
The following sections outline test cases for the multiplayer chess feature.
**Priority:** High (H), Medium (M), Low (L)
**Types:** Positive (P), Negative (N), Boundary (B), UI/UX (U), Performance (Perf), Security (Sec)

---
**General Test Case Format:**
*   **TC ID:** Unique_ID
*   **User Story/Req:** Related US/FR/NFR
*   **Description:** What is being tested.
*   **Preconditions:** Setup required before test execution.
*   **Test Steps:**
    1.  Step 1
    2.  Step 2
*   **Expected Result:** Outcome expected after executing steps.
*   **Priority:** H/M/L
*   **Type:** P/N/B/U/Perf/Sec

---

### 9.1. User Authentication (FR1, NFR4)
| TC ID      | User Story/Req | Description                                                              | Preconditions                                    | Test Steps                                                                                                                                 | Expected Result                                                                                                                  | Priority | Type    |
|------------|----------------|--------------------------------------------------------------------------|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| AUTH_001   | FR1            | Verify registered user can access multiplayer features.                    | User is registered and logged in via Clerk.      | 1. Navigate to the multiplayer section/lobby.                                                                                                | User successfully accesses the multiplayer section.                                                                              | H        | P, Sec  |
| AUTH_002   | FR1            | Verify non-authenticated user cannot access multiplayer features.        | User is not logged in.                           | 1. Attempt to navigate to the multiplayer section/lobby.                                                                                   | User is redirected to login page or shown a message indicating authentication is required. Access to features is denied.          | H        | N, Sec  |
| AUTH_003   | FR1            | Verify session expiration handling for an active game. (TBD based on FR11) | User is logged in and in an active game.         | 1. Let Clerk session expire (manual or simulated).<br>2. Attempt to make a move or interact with the game.                             | User is notified of session expiration, game state might be paused or user disconnected gracefully. Further interaction is blocked. | M        | N, Sec  |

### 9.2. Game Creation (US1, AC1, FR2)
| TC ID      | User Story/Req | Description                                                              | Preconditions                                    | Test Steps                                                                                                                                | Expected Result                                                                                                                                                             | Priority | Type    |
|------------|----------------|--------------------------------------------------------------------------|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| GC_001     | US1, AC1, FR2  | Create a new public game.                                                | User is registered and logged in.                | 1. Navigate to multiplayer lobby.<br>2. Click "Create Game".<br>3. Select "Public" game type.<br>4. Confirm creation.                     | Game is created successfully. The game appears in the public games list for other users. Creator is typically assigned White.                                             | H        | P       |
| GC_002     | US1, AC1, FR2  | Create a new private game (no direct invite initially, link/ID based).   | User is registered and logged in.                | 1. Navigate to multiplayer lobby.<br>2. Click "Create Game".<br>3. Select "Private" game type.<br>4. Confirm creation.                    | Game is created successfully. A unique game ID or link is provided to the creator for sharing. Game does NOT appear in public list.                                         | H        | P       |
| GC_003     | US1, AC1, FR2  | Verify UI elements for game creation.                                    | User is registered and logged in.                | 1. Navigate to "Create Game" interface.                                                                                                   | All necessary UI elements (public/private toggle, create button) are present and clear.                                                                                     | M        | U       |
| GC_004     | US1, FR2       | Attempt to create a game when not logged in.                             | User is not logged in.                           | 1. Attempt to access "Create Game" functionality.                                                                                         | User is prompted to log in or the option is disabled/hidden. Game creation fails.                                                                                         | H        | N       |
| GC_005     | US11, AC11, FR10 | Create a new private game by inviting a specific user.                 | User A and User B are registered and logged in.  | 1. User A navigates to "Create Game".<br>2. Selects "Private".<br>3. Enters User B's username.<br>4. Sends invitation.                  | Game is created. User B receives an invitation. Game does not appear in public list. (See Invitation System for User B's actions)                                           | H        | P       |
| GC_006     | US11, AC11, FR10 | Attempt to invite a non-existent user to a private game.               | User A is registered and logged in.              | 1. User A navigates to "Create Game".<br>2. Selects "Private".<br>3. Enters a non-existent username.<br>4. Attempts to send invitation. | An appropriate error message is displayed (e.g., "User not found"). Game is not created or invitation is not sent.                                                            | M        | N       |

### 9.3. Game Lobby & Discovery (US2, AC2, FR3)
| TC ID      | User Story/Req | Description                                                              | Preconditions                                                | Test Steps                                                                                                                               | Expected Result                                                                                                                                                              | Priority | Type    |
|------------|----------------|--------------------------------------------------------------------------|--------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| LOBBY_001  | US2, AC2, FR3  | View list of available public games.                                     | User is logged in. Multiple public games exist.            | 1. Navigate to the multiplayer lobby.                                                                                                    | A list of public, open games is displayed. Each game shows relevant details (e.g., creator, time since creation). Private games are not listed.                             | H        | P       |
| LOBBY_002  | US2, AC2, FR3  | Verify game list updates when a new public game is created.              | User A and User B are logged in, User A is in the lobby.   | 1. User B creates a new public game.<br>2. Observe User A's lobby screen.                                                              | The new public game created by User B appears in User A's lobby list automatically or after a refresh (within reasonable time, NFR1).                                        | H        | P, Perf |
| LOBBY_003  | US2, AC2, FR3  | Verify game list updates when a public game is joined/started.           | User is logged in. A public game exists and is then joined. | 1. Observe a public game in the lobby.<br>2. Another user joins this game.<br>3. Observe the lobby.                                   | The joined game is removed from the list of available games or marked as "in progress" and unjoinable.                                                                       | H        | P       |
| LOBBY_004  | US2, AC2       | Verify lobby UI elements.                                                | User is logged in.                                           | 1. Navigate to the lobby.                                                                                                                | Lobby displays game list clearly. Options to create game, refresh list (if applicable) are present. Filter/sort options are present if specified in AC2.                  | M        | U       |
| LOBBY_005  | US2, FR3       | View lobby when no public games are available.                           | User is logged in. No public games exist.                  | 1. Navigate to the multiplayer lobby.                                                                                                    | A message indicating "No public games available" or similar is displayed.                                                                                                    | M        | P       |
| LOBBY_006  | FR3            | Performance of lobby loading.                                            | User is logged in. Many public games exist (e.g., 50-100). | 1. Navigate to the multiplayer lobby.                                                                                                    | Lobby loads quickly (as per NFR1).                                                                                                                                           | M        | Perf    |

### 9.4. Joining Games (US3, AC3)
| TC ID     | User Story/Req | Description                                               | Preconditions                                                 | Test Steps                                                                                               | Expected Result                                                                                                                               | Priority | Type    |
|-----------|----------------|-----------------------------------------------------------|---------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| JOIN_001  | US3, AC3       | Join an available public game.                            | User A logged in. User B created a public game. User A is in lobby. | 1. User A sees User B's game in the lobby.<br>2. User A clicks "Join" on User B's game.                  | User A successfully joins the game as the opponent (typically Black). The game starts. Both users are transitioned to the game board interface. | H        | P       |
| JOIN_002  | US3, AC3       | Attempt to join a game that is already full (2 players).  | Public game exists with 2 players already. User A is in lobby.  | 1. User A sees the full game (or it's removed from list).<br>2. If visible, User A attempts to click "Join". | "Join" button is disabled, or an error message "Game is full" is displayed. User A cannot join.                                                 | M        | N       |
| JOIN_003  | US3, AC3       | Attempt to join a game that no longer exists.             | Public game existed but was cancelled/deleted. User A is in lobby. | 1. User A clicks "Join" on a game that was just removed.                                                 | An error message "Game not found" or similar is displayed. User A cannot join. Lobby list should update.                                          | M        | N       |

### 9.5. Turn Notifications (US4, AC4)
| TC ID     | User Story/Req | Description                                                                 | Preconditions                                                          | Test Steps                                                                                                                            | Expected Result                                                                                                                                                               | Priority | Type    |
|-----------|----------------|-----------------------------------------------------------------------------|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| TURN_001  | US4, AC4       | Verify visual notification when it's user's turn.                           | User is in an active game. It becomes their turn.                      | 1. Opponent makes a move.<br>2. Observe the game UI.                                                                                                  | A clear visual notification (e.g., text "Your Turn", highlighted clock/name) appears on the user's screen.                                                                  | H        | P, U    |
| TURN_002  | US4, AC4       | Verify optional sound notification if window is active. (If implemented)    | User is in an active game. Window is active. It becomes user's turn.   | 1. Opponent makes a move.<br>2. Listen for sound.                                                                                                     | A subtle sound notification plays.                                                                                                                                            | M        | P, U    |
| TURN_003  | US4, AC4       | Verify no sound notification if window is inactive. (If sound implemented)  | User is in an active game. Window is NOT active. It becomes user's turn. | 1. Switch to another tab/application.<br>2. Opponent makes a move.<br>3. Listen for sound.                                                          | No sound notification plays (or follows browser tab sound notification behavior). Visual notification should be visible when user returns to the game tab.                      | M        | P       |
| TURN_004  | US4, AC4       | Verify turn notification is removed/changed when user makes a move.         | User is in an active game. It is their turn.                           | 1. Make a valid move.                                                                                                                                 | The "Your Turn" notification is removed, and the UI updates to indicate it's the opponent's turn.                                                                             | H        | P, U    |

### 9.6. Real-time Move Synchronization (US5, AC5, FR4, NFR1)
| TC ID     | User Story/Req   | Description                                                              | Preconditions                                                    | Test Steps                                                                                                                              | Expected Result                                                                                                                                     | Priority | Type    |
|-----------|------------------|--------------------------------------------------------------------------|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| MOVE_001  | US5, AC5, FR4    | Opponent's move is reflected on user's board in real-time.               | User A and User B are in an active game. It's User B's turn.   | 1. User B makes a valid move.<br>2. User A observes their game board.                                                                 | User B's move is visually updated on User A's board within 2 seconds (NFR1). The game state (e.g., piece positions, whose turn) is consistent. | H        | P, Perf |
| MOVE_002  | US5, AC5, FR4    | Verify move synchronization for standard moves (pawn, knight, etc.).     | User A and User B are in an active game.                         | 1. Players make various standard chess moves.                                                                                         | All moves are correctly synchronized and displayed on both players' boards.                                                                         | H        | P       |
| MOVE_003  | US5, AC5, FR4    | Verify move synchronization for special moves (castling, en passant, promotion). | User A and User B are in a game where special moves are possible. | 1. Player performs castling.<br>2. Player performs en passant.<br>3. Player performs pawn promotion.                                  | Special moves are correctly synchronized and displayed on both boards, adhering to chess rules.                                                       | H        | P       |
| MOVE_004  | FR4, FR6         | Attempt to make an invalid move.                                         | User A and User B are in an active game. It is User A's turn.  | 1. User A attempts to make an illegal chess move.                                                                                       | The move is rejected by the system (likely `chess.js` validation). UI provides feedback. Opponent's board is not affected. It remains User A's turn. | H        | N       |
| MOVE_005  | FR4              | Attempt to make a move when it's not user's turn.                        | User A and User B are in an active game. It is User B's turn.  | 1. User A attempts to make a move.                                                                                                      | The move is rejected. UI provides feedback. Opponent's board is not affected.                                                                       | H        | N       |
| MOVE_006  | NFR1             | Test move synchronization under simulated poor network conditions.       | User A and User B in a game. Network latency simulated for User A. | 1. User B makes a move.<br>2. User A observes their board.                                                                            | Move still appears, though latency might be higher. System should handle delays gracefully without corrupting game state.                            | M        | Perf, N |

### 9.7. Draw Offers & Responses (US6, US7, AC6, AC7, FR7)
| TC ID     | User Story/Req      | Description                                                                 | Preconditions                                                    | Test Steps                                                                                                                                                              | Expected Result                                                                                                                                                                                                                                                         | Priority | Type    |
|-----------|---------------------|-----------------------------------------------------------------------------|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| DRAW_001  | US6, AC6, FR7       | Offer a draw to the opponent.                                               | User A and User B are in an active game.                         | 1. User A clicks "Offer Draw" button.                                                                                                                                 | User B receives a clear, non-intrusive notification of the draw offer. Game continues for User A until User B responds (or offer is withdrawn, if implemented).                                                                                                          | H        | P, U    |
| DRAW_002  | US7, AC7, FR7       | Accept a draw offer.                                                        | User A offered a draw to User B. User B received the offer.      | 1. User B clicks "Accept Draw".                                                                                                                                       | The game ends in a draw. Game status is updated to "Draw by Agreement" for both players. No further moves can be made.                                                                                                                                              | H        | P       |
| DRAW_003  | US7, AC7, FR7       | Decline a draw offer.                                                       | User A offered a draw to User B. User B received the offer.      | 1. User B clicks "Decline Draw".                                                                                                                                      | The game continues. The draw offer notification is dismissed for User B. User A might be notified implicitly by game continuation or explicitly (TBD).                                                                                                                 | H        | P       |
| DRAW_004  | US6, FR7            | Verify UI for "Offer Draw" button.                                          | User A and User B are in an active game.                         | 1. Observe game interface.                                                                                                                                            | "Offer Draw" button is available and clearly visible during the game.                                                                                                                                                                                                       | M        | U       |
| DRAW_005  | US7, FR7            | Verify UI for draw offer notification and response options.                 | User B receives a draw offer from User A.                        | 1. User B observes game interface.                                                                                                                                    | Clear notification of draw offer is displayed. "Accept Draw" and "Decline Draw" buttons are available.                                                                                                                                                                | M        | U       |
| DRAW_006  | FR7                 | Attempt to offer a draw when a draw offer is already pending from opponent. | User A offered draw to User B. User B has not responded.         | 1. User B attempts to click "Offer Draw".                                                                                                                             | Option should be disabled or system handles it gracefully (e.g., one offer active at a time).                                                                                                                                                                             | M        | N       |
| DRAW_007  | FR7                 | Attempt to make a move while opponent is considering a draw offer.          | User A offered draw to User B. It's User A's turn.               | 1. User A attempts to make a move.                                                                                                                                    | Game play should continue normally for the player whose turn it is, even if they made the offer. If it's User B's turn (recipient of offer), they should be able to make a move (implicitly declining) or respond to the offer. Behavior defined by game logic. | M        | P       |

### 9.8. Resignation (US8, AC8, FR8)
| TC ID     | User Story/Req | Description                                                       | Preconditions                                    | Test Steps                                                                                               | Expected Result                                                                                                                                  | Priority | Type    |
|-----------|----------------|-------------------------------------------------------------------|--------------------------------------------------|----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| RESIGN_001| US8, AC8, FR8  | Resign from a game.                                               | User A and User B are in an active game.         | 1. User A clicks "Resign" button.<br>2. Confirm resignation if prompted.                                 | Game immediately ends. User A is marked as loser, User B as winner. Game status updated for both players. No further moves can be made.        | H        | P       |
| RESIGN_002| US8, FR8       | Verify UI for "Resign" button.                                    | User A and User B are in an active game.         | 1. Observe game interface.                                                                               | "Resign" button is available and clearly visible.                                                                                                  | M        | U       |
| RESIGN_003| US8, AC8       | Verify game end status message after resignation.                   | User A resigns from a game against User B.       | 1. Both users observe the game end screen/message.                                                       | A clear message like "White resigned. Black wins." or "Black resigned. White wins." is displayed.                                                | H        | U       |

### 9.9. Game Status Display (US9, AC9, FR5, FR6)
| TC ID     | User Story/Req      | Description                                                              | Preconditions                                              | Test Steps                                                                                                                               | Expected Result                                                                                                                                 | Priority | Type    |
|-----------|---------------------|--------------------------------------------------------------------------|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| GS_001    | US9, AC9, FR5       | Verify display of current player's turn.                                 | Active game.                                               | 1. Observe game UI when it's White's turn.<br>2. Observe game UI when it's Black's turn.                                                | UI clearly indicates "White's Turn" or "Black's Turn" or equivalent visual cue.                                                                   | H        | P, U    |
| GS_002    | US9, AC9, FR6       | Verify display of "Check!" status.                                       | Active game, a player is put in check.                     | 1. Make a move that puts the opponent in check.<br>2. Both players observe the UI.                                                      | UI clearly indicates "Check!" status, possibly highlighting the king in check.                                                                    | H        | P, U    |
| GS_003    | US9, AC9, FR6       | Verify display of "Checkmate - White Wins" status.                       | Active game, White delivers checkmate.                     | 1. White makes a move resulting in checkmate.<br>2. Both players observe the UI.                                                        | UI clearly indicates "Checkmate - White Wins". Game ends.                                                                                         | H        | P, U    |
| GS_004    | US9, AC9, FR6       | Verify display of "Checkmate - Black Wins" status.                       | Active game, Black delivers checkmate.                     | 1. Black makes a move resulting in checkmate.<br>2. Both players observe the UI.                                                        | UI clearly indicates "Checkmate - Black Wins". Game ends.                                                                                         | H        | P, U    |
| GS_005    | US9, AC9, FR6       | Verify display of "Stalemate - Draw" status.                             | Active game, a stalemate position is reached.              | 1. Make a move resulting in stalemate.<br>2. Both players observe the UI.                                                               | UI clearly indicates "Stalemate - Draw". Game ends.                                                                                               | H        | P, U    |
| GS_006    | US9, AC9            | Verify display of "Draw by Agreement" status.                            | Game ended by accepted draw offer.                         | 1. Observe game UI after a draw is agreed.                                                                                               | UI clearly indicates "Draw by Agreement". Game ends.                                                                                              | H        | P, U    |
| GS_007    | US9, AC9            | Verify display of "Draw by Resignation (White/Black resigned)" status.   | Game ended by resignation.                                 | 1. Observe game UI after a player resigns.                                                                                               | UI clearly indicates appropriate resignation message (e.g., "White Resigned - Black Wins"). This is covered by RESIGN_003 but good to list here. | H        | P, U    |

### 9.10. Game History (US10, AC10, FR9)
| TC ID     | User Story/Req | Description                                                         | Preconditions                                                                 | Test Steps                                                                                                                            | Expected Result                                                                                                                                                               | Priority | Type    |
|-----------|----------------|---------------------------------------------------------------------|-------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| GH_001    | US10, AC10, FR9 | View personal multiplayer game history.                             | User is logged in and has completed several multiplayer games.              | 1. Navigate to the "Game History" section.                                                                                            | A list of completed games is displayed. Each entry shows opponent, user's color, game result, and date.                                                                       | H        | P       |
| GH_002    | US10, AC10, FR9 | Verify game history updates after a game concludes.                 | User is logged in, completes a new game.                                      | 1. Play and complete a multiplayer game.<br>2. Navigate to "Game History".                                                            | The newly completed game appears in the history with correct details.                                                                                                         | H        | P       |
| GH_003    | US10, FR9      | View game history when no games have been played.                   | User is logged in and has not played any multiplayer games.                 | 1. Navigate to "Game History" section.                                                                                                | A message indicating "No game history available" or similar is displayed.                                                                                                       | M        | P       |
| GH_004    | US10, AC10     | Verify game history UI elements.                                    | User is logged in.                                                            | 1. Navigate to "Game History" section.                                                                                                | History list is clearly presented. Information per game (opponent, result, date, color) is accurate and readable. Sort/filter options if implemented.                         | M        | U       |

### 9.11. Invitation System (US11, AC11, FR10)
| TC ID      | User Story/Req      | Description                                                              | Preconditions                                                                | Test Steps                                                                                                                                                                                                                                                             | Expected Result                                                                                                                                                                                                                                                            | Priority | Type    |
|------------|---------------------|--------------------------------------------------------------------------|------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| INVITE_001 | US11, AC11, FR10    | User A invites User B to a private game. User B accepts.                 | User A and User B are registered, logged in, and not in a game.            | 1. User A initiates a private game invite to User B (e.g., via username through create game flow).<br>2. User B receives a notification of the invitation.<br>3. User B accepts the invitation.                                                                          | A private game starts between User A and User B. Both users are navigated to the game board. The game is not listed in the public lobby.                                                                                                                                   | H        | P       |
| INVITE_002 | US11, AC11, FR10    | User A invites User B to a private game. User B declines.                | User A and User B are registered, logged in, and not in a game.            | 1. User A initiates a private game invite to User B.<br>2. User B receives a notification of the invitation.<br>3. User B declines the invitation.                                                                                                             | The game is not started. User A is notified that the invitation was declined (or game creation simply fails/is cancelled). User B's notification is dismissed.                                                                                                             | H        | P       |
| INVITE_003 | US11, FR10          | Verify invitation notification UI for the invited user.                    | User B receives an invitation from User A.                                   | 1. User B observes the UI for the invitation notification.                                                                                                                                                                                                             | A clear, non-obtrusive notification is displayed, showing who sent the invite. "Accept" and "Decline" options are available.                                                                                                                                            | H        | U       |
| INVITE_004 | US11, FR10          | Attempt to invite a user who is currently offline.                       | User A logged in. User B (target) is a registered user but offline.          | 1. User A attempts to invite User B.                                                                                                                                                                                                                                   | System behavior TBD by spec (e.g., "User is offline" message, or invitation remains pending until User B logs in - assuming former for MVP unless specified). For now, assume an error or simple failure.                                                                | M        | N       |
| INVITE_005 | US11, FR10          | Attempt to invite a user who is already in another game.                 | User A logged in. User B (target) is registered and in an active game.       | 1. User A attempts to invite User B.                                                                                                                                                                                                                                   | System behavior TBD by spec (e.g., "User is busy" message, or invitation fails). For now, assume an error or simple failure.                                                                                                                                          | M        | N       |
| INVITE_006 | US11, FR10          | Invitation expires or is cancelled if inviting user navigates away/logs out (TBD). | User A invites User B. Before B responds, A navigates away or logs out. | 1. Test scenario as described.                                                                                                                                                                                                                                         | Behavior to be defined by detailed specs. Invitation might become invalid. User B trying to accept might get an error.                                                                                                                                               | L        | N       |
| INVITE_007 | FR10                | User A attempts to invite themselves.                                    | User A is logged in.                                                         | 1. User A tries to input their own username in the invitation field.                                                                                                                                                                                                   | Invitation should fail, an error message like "Cannot invite yourself" should be displayed.                                                                                                                                                                              | M        | N       |

### 9.12. Connection Handling (FR11)
| TC ID     | User Story/Req | Description                                                                 | Preconditions                                                         | Test Steps                                                                                                                                                              | Expected Result                                                                                                                                                                           | Priority | Type    |
|-----------|----------------|-----------------------------------------------------------------------------|-----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| CONN_001  | FR11           | Opponent disconnects during a game (e.g., closes browser/tab).            | User A and User B in an active game. User B disconnects abruptly.     | 1. User B closes their browser tab or simulates network loss.<br>2. User A observes the game UI.                                                                      | User A receives a notification like "Opponent disconnected". Game might be paused. Specific outcome (forfeit after timeout, allow reconnection) as per FR11's final definition.          | H        | N       |
| CONN_002  | FR11           | User disconnects and attempts to reconnect to an ongoing game (if supported). | User A disconnects from an active game and reconnection is supported. | 1. User A disconnects (e.g., network drop).<br>2. User A restores connection and navigates back to the game.                                                           | User A successfully reconnects to the game, and the game state is restored to the point of disconnection. (This is highly dependent on NFR3 and FR11 detailed implementation).      | M        | P       |
| CONN_003  | FR11           | WebSocket server connection lost and re-established.                        | Users are in an active game or lobby.                                 | 1. Simulate WebSocket server temporary unavailability and then recovery.<br>2. Observe client behavior.                                                                 | Clients attempt to reconnect. Upon successful reconnection, game/lobby state is restored or updated. Clear messaging if reconnection fails permanently.                              | M        | N, Perf |

### 9.13. Non-Functional Requirements (NFR1, NFR3, NFR4, NFR5)
| TC ID     | User Story/Req | Description                                                           | Preconditions                                                              | Test Steps                                                                                                                                                           | Expected Result                                                                                                                                                                | Priority | Type    |
|-----------|----------------|-----------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|---------|
| NFR_PERF_001 | NFR1        | Verify move transmission latency.                                     | Two users in an active game, stable network.                             | 1. User A makes a move.<br>2. Measure time until User B sees the move. Repeat multiple times.                                                                      | Latency is consistently < 2 seconds.                                                                                                                                            | H        | Perf    |
| NFR_PERF_002 | NFR1        | Verify lobby loading speed.                                           | Lobby contains a moderate number of games (e.g., 20-30).                   | 1. Navigate to the game lobby.<br>2. Measure time until games are displayed.                                                                                           | Lobby loads quickly (subjective "quick" for MVP, aim for < 3-5 seconds).                                                                                                        | M        | Perf    |
| NFR_REL_001  | NFR3        | Verify game state persistence after browser refresh (if applicable).  | User in an active game.                                                    | 1. Make several moves.<br>2. Refresh the browser page.<br>3. Observe if the game resumes from the correct state (depends on reconnection logic).                    | If reconnection is supported, the game state is correctly restored. Otherwise, this might be a disconnect scenario (CONN_001).                                                  | M        | P, N    |
| NFR_SEC_001  | NFR4        | Verify multiplayer features require authentication (covered by AUTH_002). | -                                                                          | -                                                                                                                                                                    | -                                                                                                                                                                              | H        | Sec     |
| NFR_USA_001  | NFR5        | Overall UI intuitiveness for game creation and joining.               | New user.                                                                  | 1. Ask a user unfamiliar with the system to create a public game.<br>2. Ask them to join an existing public game.                                                   | User can complete tasks with minimal confusion. UI elements are self-explanatory.                                                                                                  | H        | U       |
| NFR_USA_002  | NFR5        | Clarity of in-game notifications (turns, check, draw offers, etc.).   | User in various game scenarios.                                            | 1. Trigger different game events (turn change, check, draw offer).<br>2. Observe notifications.                                                                      | Notifications are clear, easily noticeable but not overly intrusive. Their meaning is unambiguous.                                                                               | H        | U       |

---
**End of Test Cases**